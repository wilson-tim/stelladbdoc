<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=Cp1252" />
<script src="ISRECORDTYPESEQVALID/report.js" type="text/javascript"></script>
<link href="ISRECORDTYPESEQVALID/report.css" type="text/css" rel="stylesheet">
</head>
<body>
<div class="banner">
<table width="98%"><tr>
<td><h2 class="banner">ISRECORDTYPESEQVALID</h2></td>
</tr></table></div>
<div id="maintabs">
<div class="currentmaintab" onclick="onSelectMainTab(this, 0)">
<div>
<p>Doc</p>
</div>
</div>
<div class="maintab" onclick="onSelectMainTab(this, 1)">
<div>
<p>Details</p>
</div>
</div>
<div class="maintab" onclick="onSelectMainTab(this, 2)">
<div>
<p>Grants</p>
</div>
</div>
<div class="maintab" onclick="onSelectMainTab(this, 3)">
<div>
<p>References</p>
</div>
</div>
<div class="maintab" onclick="onSelectMainTab(this, 4)">
<div>
<p>Dependencies</p>
</div>
</div>
<div class="maintab" onclick="onSelectMainTab(this, 5)">
<div>
<p>Code</p>
</div>
</div>
</div>
<br/>
<div id="masterreports">
<div id="Master.0">
<div class="currentmasterreport">
<TABLE CELLSPACING="0" CELLPADDING="1" WIDTH="100%" BORDER="0">
<TR><TD CLASS="NavBarRow3" VALIGN="top"><FONT SIZE="-2">      SUMMARY:  <A HREF="#field_summary">FIELD</A> | <A HREF="#type_summary">TYPE</A> | <A HREF="#method_summary">METHOD</A></FONT></TD><TD CLASS="NavBarRow3" VALIGN="top"><FONT SIZE="-2"></TR></TABLE><HR><P></P><HR><P></P><A NAME="method_summary"></A><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="3" BORDER="1"><TR CLASS="TableHeadingColor"><TD COLSPAN="2"><FONT SIZE="+2"><B>Method Summary</B></FONT></TD><TR CLASS="TableRowColor"><TD WIDTH="1%" VALIGN="top" ALIGN="right"><FONT SIZE="-1"><CODE>&nbsp;</CODE></FONT></TD><TD><CODE><B><A HREF="#isRecordTypeSeqValid">isRecordTypeSeqValid</A></B>( i_prevRecType in varchar2 , i_currentRecType in varchar2 ) return VARCHAR2 as v_valid varchar2 ( 1 ) </CODE><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @I:\MI\DarrenScott\Workspace\UK\Database\dtwlive\stella\funcs\ISRECORDTYPESEQVALID_1.1.fnc</TD></TR>
</TABLE>
<P></P><A NAME="method_detail"></A><TABLE WIDTH="100%" CELLSPACING="0" CELLPADDING="3" BORDER="1"><TR CLASS="TableHeadingColor"><TD COLSPAN="2"><FONT SIZE="+2"><B>Method Detail</B></FONT></TD></TABLE><A NAME="isRecordTypeSeqValid"></A>
<H3>isRecordTypeSeqValid</H3><PRE>          <B>isRecordTypeSeqValid</B>( i_prevRecType in varchar2 , i_currentRecType in varchar2 ) return VARCHAR2 as v_valid varchar2 ( 1 ) </PRE><DL>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; @I:\MI\DarrenScott\Workspace\UK\Database\dtwlive\stella\funcs\ISRECORDTYPESEQVALID_1.1.fnc<DD><DL></DL></DD></DL><HR><TABLE CELLSPACING="0" CELLPADDING="1" WIDTH="100%" BORDER="0">
<TR><TD CLASS="NavBarRow3" VALIGN="top"><FONT SIZE="-2">      SUMMARY:  <A HREF="#field_summary">FIELD</A> | <A HREF="#type_summary">TYPE</A> | <A HREF="#method_summary">METHOD</A></FONT></TD><TD CLASS="NavBarRow3" VALIGN="top"><FONT SIZE="-2"></TR></TABLE></div>
</div>
<div id="Master.1">
<div class="masterreport">
<table id="Table.0" cellpadding="0" cellspacing="0" summary="">
<th>NAME</th>
<th>VALUE</th>
</tr>
<tr>
<td>OWNER</td>
<td>STELLA</td>
</tr>
<tr>
<td>OBJECT_NAME</td>
<td>ISRECORDTYPESEQVALID</td>
</tr>
<tr>
<td>SUBOBJECT_NAME</td>
<td>null</td>
</tr>
<tr>
<td>OBJECT_ID</td>
<td>3520040</td>
</tr>
<tr>
<td>DATA_OBJECT_ID</td>
<td>null</td>
</tr>
<tr>
<td>OBJECT_TYPE</td>
<td>FUNCTION</td>
</tr>
<tr>
<td>CREATED</td>
<td>11-NOV-19</td>
</tr>
<tr>
<td>LAST_DDL_TIME</td>
<td>15-JAN-20</td>
</tr>
<tr>
<td>TIMESTAMP</td>
<td>2019-12-11:11:59:49</td>
</tr>
<tr>
<td>STATUS</td>
<td>VALID</td>
</tr>
<tr>
<td>TEMPORARY</td>
<td>N</td>
</tr>
<tr>
<td>GENERATED</td>
<td>N</td>
</tr>
<tr>
<td>SECONDARY</td>
<td>N</td>
</tr>
<tr>
<td>NAMESPACE</td>
<td>1</td>
</tr>
<tr>
<td>EDITION_NAME</td>
<td>null</td>
</tr>
</table>
</div>
</div>
<div id="Master.2">
<div class="masterreport">
<table id="Table.1" cellpadding="0" cellspacing="0" summary="">
<tr>
<th>PRIVILEGE</th>
<th>GRANTEE</th>
<th>GRANTABLE</th>
<th>GRANTOR</th>
<th>OBJECT_NAME</th>
</tr>
</table>
</div>
</div>
<div id="Master.3">
<div class="masterreport">
<table id="Table.2" cellpadding="0" cellspacing="0" summary="">
<tr>
<th>NAME</th>
<th>OWNER</th>
<th>TYPE</th>
<th>OBJECT_ID</th>
<th>STATUS</th>
<th>TYPE_LINK</th>
</tr>
</table>
</div>
</div>
<div id="Master.4">
<div class="masterreport">
<table id="Table.3" cellpadding="0" cellspacing="0" summary="">
<tr>
<th>NAME</th>
<th>OWNER</th>
<th>TYPE</th>
<th>OBJECT_ID</th>
<th>STATUS</th>
<th>TYPE_LINK</th>
</tr>
</table>
</div>
</div>
<div id="Master.5">
<div class="masterreport">
<pre>
function        isRecordTypeSeqValid( i_prevRecType in varchar2, i_currentRecType in varchar2)--, recordText in varchar2, p_fileName in varchar2)

        /** validates that the sequence of records in the file is OK.
         *returns true IF valid sequence , false IF not expected sequence
         **/
        --===========================================================
        -- Change History
        --===========================================================
        -- Date         Ver    Who          Comment
        -- 02-Dec-19    1.0    DScott       Original Version
        -- 11-Dec-19    1.1    DScott       Added BMD to be accepted by BKP record id.
        --
        -- @I:\MI\DarrenScott\Workspace\UK\Database\dtwlive\stella\funcs\ISRECORDTYPESEQVALID_1.1.fnc


    return VARCHAR2 as

v_valid varchar2(1);

begin
    v_valid := 'N';



 IF i_currentRecType = ('BFT') 
            AND i_prevRecType NOT IN ('BCT' )
    THEN   v_valid := 'N';


    ELSIF i_currentRecType = 'BOH'
            AND i_prevRecType NOT IN ('BCH','BOT') 
        THEN        v_valid := 'N';


    ELSIF i_currentRecType = 'BKT'
            AND i_prevRecType NOT IN ('BOH','BKP','BOT') 
        THEN        v_valid := 'N';


    ELSIF i_currentRecType = 'BKS' 
            AND i_prevRecType NOT IN ('BKT','BKS','BKF','BKI') 
        THEN        v_valid := 'N';


    ELSIF i_currentRecType = 'BKI' 
            AND i_prevRecType NOT IN ('BKS','BKI') 
        THEN        v_valid := 'N';


    ELSIF i_currentRecType = 'BAR'
            -- Added JR, 21/01/05
            --IF current record type is BAR than Previous record type can also be BKS
            AND i_prevRecType NOT IN ('BKI','BAR','BKS')
               THEN        v_valid := 'N';


        ---// Added JR, 21/01/05
       --- // IF current record type is BMP than previous record type can be BAR or BMP
    ELSIF i_currentRecType = 'BMP'
            AND i_prevRecType not in ('BAR','BMP')
               THEN        v_valid := 'N';



    ELSIF i_currentRecType = 'BKF'  
            AND i_prevRecType NOT IN ('BAR','BKF','BMD')
                 THEN        v_valid := 'N';



    ELSIF i_currentRecType = 'BCT'
            AND i_prevRecType NOT IN ('BOT')
               THEN        v_valid := 'N';


    ELSIF i_currentRecType = 'BCH'
            AND i_prevRecType NOT IN ('BFH','BCT')   ---// 06/12/05 added BCT as previous record to BCH , to load new formated BSP file
                 THEN        v_valid := 'N';



        --// Added JR, 21/01/05
        --// IF current record type is BKP than added previous record type as BMP
        --//LA 030907 need to allow BKF before BKP but also allow BAR before BKP i.e. BKF is optional
        --// so allowed BAR to preceed a BKP

    ELSIF i_currentRecType = 'BKP'
           AND i_prevRecType NOT IN ('BKS','BKI','BKP','BKF','BMP','BAR','BMD') 
                 THEN        v_valid := 'N';



    ELSIF (i_currentRecType = ('BOT') ) 
            AND i_prevRecType NOT IN ('BKP','BOT')
                 THEN        v_valid := 'N';


    ELSIF i_prevRecType = 'BOH'
            AND i_currentRecType NOT IN ('BKT') 
               THEN        v_valid := 'N';






    ELSE 
           /*  --// record ID has not been entered into this validation correctly
            failMessage = 'rectype not validated properly, prev: ' + i_prevRecType + ' cur: ' +
            i_currentRecType;
            return deliberateCrashOut(failMessage); */



       -- // otherwise to have gotten this far, must be valid

        --return true;

        v_valid := 'Y';


  END IF;


        --dbms_output.put_line('rec is '||v_valid);


    return (v_valid);

EXCEPTION 
   WHEN OTHERS THEN

     --String failMessage = 'ERROR datafile: ' + fileName + ' invalid record sequence. Prev: ' + i_prevRecType + ' current: ' + i_currentRecType + '(record was: ' + recordText + ')';
     return ('N');

end IsRecordTypeSeqValid;
</pre>
</div>
</div>
</div>
</body>
</html>
